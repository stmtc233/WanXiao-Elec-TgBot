# 完美校园电费监控 Telegram Bot (WanXiao Elec Bot)

这是一个基于 Go 语言编写的 Telegram 机器人，用于查询完美校园（WanXiao）绑定的宿舍剩余电量，并支持低电量自动预警功能。

## 功能特性

*   **交互式菜单**：通过底部键盘和按钮进行操作，无需记忆复杂命令。
*   **多账号管理**：支持绑定和解绑多个完美校园账号。
*   **实时查询**：一键查询所有绑定账号的当前剩余电量。
*   **低电量预警**：后台定时监控电量，低于设定阈值时自动发送通知。
*   **个性化设置**：支持自定义预警阈值、开启/关闭预警以及检查频率。

## 快速开始

### 1. 获取 Bot Token
向 Telegram 的 [BotFather](https://t.me/BotFather) 申请一个新的 Bot，并获取 Token。

### 2. 配置
在程序运行目录下创建一个 `config.json` 文件（可参考 `config.json.example`），填入你的 Token：

```json
{
  "bot_token": "你的_TELEGRAM_BOT_TOKEN"
}
```

或者，你也可以设置环境变量 `BOT_TOKEN`。

### 3. 运行

#### 编译运行
确保你已安装 Go 环境。

```bash
# 初始化依赖
go mod tidy

# 编译
go build -o wanxiao-bot .

# 运行
# Windows
.\wanxiao-bot.exe

# Linux/Mac
./wanxiao-bot
```

## 使用指南

发送 `/start` 命令启动机器人，即可看到底部菜单栏：

*   **🔌 查询电量**：点击后机器人会自动查询并返回所有绑定宿舍的最新电量信息。
*   **👤 账号管理**：
    *   查看已绑定的账号列表。
    *   点击 **➕ 添加账号** 按钮，根据提示依次输入账号和客户代码即可完成绑定。
    *   点击账号下方的 **❌ 解绑** 按钮可删除该账号。
*   **⚙️ 预警设置**：
    *   查看当前的报警阈值、开关状态和检查间隔。
    *   **📉 修改阈值**：设置电量低于多少度时报警。
    *   **⏱️ 修改间隔**：设置后台自动检查电量的频率（分钟）。
    *   **🔔 开关预警**：一键开启或关闭报警通知。

## 技术栈

*   **Go** (Golang)
*   **Telebot v3**: Telegram Bot API 框架
*   **GORM**: ORM 库 (使用 SQLite 存储数据)
*   **Cron v3**: 定时任务调度

## 注意事项

*   本程序仅用于学习交流，请勿用于非法用途。
*   API 来源于对完美校园 App 的抓包分析，可能会随官方更新而失效。
*   `customercode` (客户代码) 是学校在完美校园系统中的唯一标识，需自行获取。

## License

MIT
